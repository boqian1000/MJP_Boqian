\section{Geometrical ergodicity}
\begin{assumption}
$\exists$ $k_2 > k_1 > 1$ and $\epsilon_1, \epsilon_2 > 0$, s.t. $k_2 ( \{ \max_s|A_{ss}(\theta)| +  \max_s|A_{ss}(\nu)| ) + \epsilon_2 \geq \Omega(\theta, \nu)$ and $\Omega(\theta, \nu) \geq k_1 \max \{ \max_s|A_{ss}(\theta)|, \max_s|A_{ss}(\nu)| \} + \epsilon_1.$ 
\end{assumption}

\begin{assumption}
Given the proposal density $q(\mu | \theta)$, $\exists \eta_0 \in (0, 1)$ s.t. $$ \int_\Theta \max_s|A_{ss}(\nu)| q(\nu | \theta)d\nu \leq \eta_0 \max_s|A_{ss}(\theta)|.$$
\end{assumption}

\begin{assumption}
$\exists$ $ \xi_1 > \eta_1 > 0$ s.t. $\prod P(x_o | s_o, \theta) \in (\eta_1, \xi_1)$.
\end{assumption}



\begin{assumption}
For the ideal sampler with the proposal density $q(\nu| \theta)$ and the acceptance rate $\alpha_i(\theta, \nu) = 1 \wedge \frac{P(X | \nu)q(\theta| \nu)p_0(\nu)}{P(X | \nu)q(\nu| \theta)p_0(\theta)}$, $\exists$ a probability measure $\phi$, a constant $\kappa_1 > 0$ and a set $C \subseteq \Theta$, s.t. $q(\nu | \theta) \alpha_i(\theta, \nu) \geq \kappa_1 \phi(\nu)$ for $\theta \in C$. 
\end{assumption}

\begin{assumption}
For the above $C \subseteq \Theta$, $\exists$ $\bar{\Omega} > 0$ s.t. $\Omega(\theta, \nu)  \leq \bar{\Omega}$ for $\forall (\theta, \nu) \in C \times C$.
\end{assumption}

\begin{theorem}
Under the above assumptions, for $\forall h > 0$, the set $\{ (W, \theta, \theta^*) | |W| \leq h, \theta \in C \}$ is a small set.
\end{theorem}
\begin{proof}
\begin{align*}
P(W', \nu, \theta | W, \theta, \theta^*) &\geq q(\nu | \theta)\alpha(\theta, \nu, W') \int_T \sum_S P(S,T | W, \theta, \theta^*, X) P(W'| S, T, \theta, \nu)dT  
\end{align*}
\begin{align*}
P(S, T = \emptyset | W, \theta, \theta^*, X) & \geq p_0(s_0)\prod P(V_{i + 1} = s_0 | V_i = s_0) \prod P(X_{[w_i, w_{i + 1})} | v_i = s_0, \theta)\\
& \geq p_0(s_0)(1 - 1/k_1)^{|W|}\eta_1
\end{align*}
Given $T = \emptyset$ and $S = [s_0]$, $W'$ is a poisson process with rate $r(\theta, \nu, s_0) = \Omega(\theta, \nu) - |A|_{s_0}(\theta) > \epsilon_1 > 0$. Applying thinning theorem, $PP(r(\theta, \nu, s_0)) = PP(\epsilon_1) \cup PP(r(\theta, \nu, s_0) - \epsilon_1)$.
\begin{align*}
P(W' | S, T = \emptyset, \theta, \nu) & \geq P(W' from PP(\epsilon_1)) P(\emptyset from PP(r(\theta, \nu, s_0) - \epsilon_1))\\
& \geq P(W' from PP(\epsilon_1)) \exp(-\Omega(\theta, \nu)) \geq P(W' from PP(\epsilon_1)) \exp(-\bar{\Omega})\delta_C(\nu)
\end{align*}
\begin{align*}
\int_T \sum_S P(S,T | W, \theta, \theta^*, X) P(W'| S, T, \theta, \nu)dT &\geq \sum_S P(S, T = \emptyset | W, \theta, \theta^*, X) P(W' | S, T=\emptyset,\theta, \nu)\\
& \geq (1 - 1/k_1)^{|W|}\eta_1 \exp(-\bar{\Omega}) P(W' from PP(\epsilon_1))\delta_C(\nu)
\end{align*}
Consider the acceptance rate.
\begin{align*}
\alpha(\theta, \nu, W') &= 1 \wedge \frac{P(X | W', \nu, \theta) q(\theta|\nu)p_0(\nu)}{P(X | W', \theta, \nu)q(\nu|\theta)p_0(\theta)}\\
& \geq \alpha_i(\theta, \nu)(1 \wedge \frac{P(X|W', \nu, \theta) / P(X|\nu)}{P(X|W', \theta, \nu) / P(X|\theta)}) \geq \alpha_i(\theta, \nu)\eta_1^2
\end{align*}
Combine the property of the ideal sampler, we have the following inequality.
\begin{align*}
P(W', \nu, \theta | W, \theta, \theta^*) \geq (1 - 1/k_1)^{h} \eta_1^3 \exp(-\bar{\Omega})\kappa_1 P(W' from PP(\epsilon_1))\phi(\nu)\delta_C(\nu)
\end{align*}
\end{proof}

\begin{lemma}
$\exists \delta_1 \in (0, 1)$ s.t. $\mathbb{E}[\mathbb{I}_{\{V_i = V_{i + 1}\}} | W, X, \theta, \theta^*] \geq \delta_1$ for $i = 0, 1, 2, ..., |W|$. 
\end{lemma}
\begin{proof}
\begin{align*}
\mathbb{E}[\mathbb{I}_{\{V_i = V_{i + 1}\}} | W, X, \theta, \theta^*] &\geq P(V_i = V_{i + 1} | W, X, \theta, \theta^*) = \sum_v P(V_i = V_{i + 1} = v | W, X, \theta, \theta^*)\\
& =\sum_v \frac{P(V_i = V_{i + 1} = v, X | W, \theta, \theta^*)}{P(X | W, \theta, \theta^*)} \\
&=\sum_v \frac{P(X | V_i = V_{i + 1} = v, W, \theta, \theta^*)P( V_i = V_{i + 1} = v|W, \theta, \theta^*)}{P(X | W, \theta, \theta^*)}\\
& \geq \eta_1\sum_v P(V_i = V_{i + 1} = v | W) /\xi_1 =  \eta_1 \sum_v P(V_{i + 1} = v | V_i = v, W)P(V_i = v) /\xi_1 \\
& \geq \eta_1 (1 - 1/k_1)/\xi_1 \doteq \delta_1 
\end{align*}
\end{proof}
\begin{theorem}
$\exists \delta_2 \in (0, 1), L > 0$ s.t. $\mathbb{E}[|W'| | W, \theta, \theta^*, X] \leq (1 - \delta_2)|W| + L$.
\end{theorem}
\begin{proof}
Since $W' = T \cup U'$, we consider $\mathbb{E}[|T| | W, \theta, \theta^*, X]$ and $\mathbb{E}[|U'| | W, \theta, \theta^*, X]$ respectively.
An upper bound of $\mathbb{E}[|T| | W, \theta, \theta^*]$ can be derived directly from lemma 1.
\begin{align*}
\mathbb{E}[|T| | W, \theta, \theta^*, X] &= \mathbb{E}[\sum_{i = 0}^{|W| - 1} \mathbb{I}_{\{ V_{i + 1} = V_i \}}| W, \theta, \theta^*, X]\\
&\leq \sum_{i = 0}^{|W| - 1} (1 - \delta_1) = |W|(1 - \delta_1).
\end{align*}
\begin{align*}
\mathbb{E}[|U'| |W, \theta, \theta^*, X] &= \mathbb{E}_{S,T, \nu}\mathbb{E}[|U'| | S, T, W, \theta, \nu, X] = \mathbb{E}_{S,T, \nu}\mathbb{E}[|U'| | S, T, W, \theta, \nu] \\
& \leq \mathbb{E}_{S,T, \nu} (t_{end} - t_{start})\Omega(\theta, \nu) = (t_{end} - t_{start})\int \Omega(\theta, \nu) q(\nu | \theta) d\nu\\
& \leq (t_{end} - t_{start})( k_2 (  \max_s|A_{ss}(\theta)| +  \int_\Theta \max_s|A_{ss}(\nu)|q(\nu | \theta)d\nu ) + \epsilon_2) \\
& \leq (t_{end} - t_{start}) (k_2 (\eta_0 + 1) \max_s|A_{ss}(\theta)| + \epsilon_2) \doteq a \max_s|A_{ss}(\theta)| + b.
\end{align*}
Consider the transition kernel of the sampler.

\begin{align*}
P(dW', d\mu, \theta | W, \theta, \theta^*) &=d\nu dW' [q(\nu | \theta) \int \sum_S P(S, T | W, \theta, \theta^*, X)P(W' | S, T, \theta, \nu)dT\alpha(\theta, \nu | W', X)\\
&+ \int_\Theta q(\mu | \theta) \int \sum_S P(S, T | W, \theta, \theta^*, X)P(W' | S, T, \theta, \mu)dT ( 1 - \alpha(\theta, \nu | W', X))d\mu \delta_\theta(\nu)].
\end{align*}
Integrate out $W'$, then we get the following.
\begin{align*}
P(d\mu| W, \theta, \theta^*) &=d\nu \int_{W'}dW' [q(\nu | \theta) \int \sum_S P(S, T | W, \theta, \theta^*, X)P(W' | S, T, \theta, \nu)dT\alpha(\theta, \nu | W', X)\\
&+ \int_\Theta q(\mu | \theta) \int \sum_S P(S, T | W, \theta, \theta^*, X)P(W' | S, T, \theta, \mu)dT ( 1 - \alpha(\theta, \nu | W', X))d\mu \delta_\theta(\nu)]\\
&\leq d\nu[q(\nu | \theta) +1 -  \int q(\mu | \theta) \sum_S P(S, T|W, \theta, \theta^*, X)P(W'|S, T, \theta, \mu)\alpha(\theta, \nu | W', X)d\mu dW' dT \delta_\theta(\nu)]\\
& \leq d\nu [q(\nu | \theta) + (1 - \eta_1^2 \int_\Theta q(\mu | \theta)\alpha_i(\theta, \mu))\delta_\theta(\nu)]\\
& \leq d\nu [q(\nu | \theta) + 1 - \eta_1^2 \kappa_1 \mathbb{P}_\phi(C)\delta_\theta(\nu)].
\end{align*}
Because of assumption 2, we have the following.
\begin{align*}
\int_\Theta \max_s|A_{ss}(\nu)|P(d\nu| W, \theta, \theta^*) d\nu \leq (\eta_0 + 1 - \eta_1^2 \kappa_1 \mathbb{P}_\phi(C)) \max_s|A_{ss}(\theta)| \doteq (1 - \delta_2) \max_s|A_{ss}(\theta)|,
\end{align*}
where $\delta_2 \in (0, 1)$.
So there exist a $N, L > 0$  and $\delta_3 \in (0, 1)$s.t. 
$$\mathbb{E}[|W'| + N\max_s|A_{ss}(\nu)  | W, \theta, \theta^*, X] \leq (1 - \delta_3)(|W| + N\max_s|A_{ss}(\theta) ) + L$$. The drift condition is satisfied.
\end{proof}
